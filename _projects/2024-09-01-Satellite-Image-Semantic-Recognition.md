---
layout: single
author_profile: true
title: "卫星图像语义识别"
collection: projects
category: ai
permalink: /projects/2024-09-01-Satellite-Image-Semantic-Recognition
excerpt: 'Satellite_Image_Semantic_Recognition ..........'
date: 2024-06-01
---

# 基于 Vision Transformer 与 LoRA 微调的灾后道路检测卫星图像语义分割

## 项目概述
本项目旨在对卫星遥感图像进行高精度语义分割，以识别道路、植被、建筑及车辆等关键地物信息，用于灾后道路通行能力评估与最优路径规划。项目结合 Vision Transformer 的全局建模能力与 LoRA（Low-Rank Adaptation）参数高效微调技术，在保证高精度的同时显著降低训练成本，实现高分辨率遥感图像的高效像素级识别。

---

## 数据集与预处理

### 1. 数据来源
原始数据集包含四组高分辨率卫星图像，并按照 **4:1 比例划分训练集与验证集**，确保模型训练稳定性与泛化能力评估的可靠性。

---

### 2. 数据标注
- 使用 **ISAT（Interactive Semantic Annotation Tool）** 与 **Segment Anything** 进行联合标注  
- ISAT 提供交互式精细标注界面  
- Segment Anything 提供通用分割能力辅助标注  

二者结合实现：

- 高精度标签生成  
- 标注时间显著降低  
- 标签一致性提升  

---

### 3. 数据增强
为解决遥感数据量不足问题，对原始数据进行多策略扩增：

- 随机裁剪
- 平移变换
- 旋转变换
- 翻转增强
- 颜色扰动

最终将数据规模从 **4组扩展至 10,000 组样本**，显著提升模型对不同场景、光照与尺度变化的适应能力。

---

### 4. 数据预处理流程
数据加载与处理采用 OpenCV 实现自动化管线：

- 图像与灰度标签同步加载
- 随机裁剪生成训练patch
- PNG格式保存
- CSV记录路径索引

该流程确保：

- 数据读取速度快
- 内存占用低
- 训练稳定性高

---

## 模型架构设计

### 1. Backbone：Vision Transformer + LoRA 微调

采用预训练 **ViT-L/14** 作为特征提取 backbone，并引入 **LoRA 参数高效微调机制**：

#### LoRA核心思想
冻结原始ViT权重，仅在注意力层插入低秩矩阵：

\[
W' = W + AB
\]

其中：

- A ∈ ℝ^{d×r}
- B ∈ ℝ^{r×d}
- r ≪ d

优势：

- 可训练参数减少 >90%
- 显存占用显著降低
- 收敛速度提升
- 保留预训练特征表达能力

LoRA 注入位置：

- Attention Q层
- Attention V层

实践验证这两层对任务适配最关键。

---

### 2. 分割模型结构（MyModelSeg）

在ViT输出特征基础上构建轻量级解码器：

结构组成：

- 特征重排层（Token → Feature Map）
- 卷积层
- 上采样层
- ReLU 激活函数

作用：

- 恢复空间分辨率
- 提供像素级预测能力
- 保持边界细节信息

---

### 3. 高分辨率推理策略
由于遥感图像分辨率极高，推理阶段采用：

**Sliding Window 推理策略**

优势：

- 避免显存溢出
- 保持全图空间一致性
- 提升大尺度场景识别稳定性

---

## 训练方法

### 优化器
AdamW  
优势：

- 更稳定收敛
- 权重衰减合理
- 防止过拟合

---

### 损失函数
采用 Dice Loss：

原因：

- 对类别不平衡鲁棒
- 更适合像素级任务
- 对小目标（车辆）识别更友好

---

### 学习率策略
使用 **LinearLR 调度器**

作用：

- 初期稳定训练
- 后期平滑收敛
- 防止震荡

---

### 训练配置

| 参数 | 设置 |
|----|----|
Batch Size | 32 |
GPU | RTX 4090D |
显存 | 24GB |
迭代次数 | 20,000 |
训练时长 | 约3小时 |

---

## 项目成果

### 分割性能
**总体准确率：82.65%**

---

### 识别效果
模型成功实现：

- 道路精准提取
- 植被区域分割
- 建筑轮廓识别
- 道路车辆检测

尤其在灾后场景中可快速判断：

> 哪些道路可通行  
> 哪些区域受阻  

---

## 技术亮点总结

✔ 引入 LoRA 微调实现高性能 + 低成本训练  
✔ 使用 ViT 捕获遥感图像长距离依赖关系  
✔ 数据增强扩展至 10k 样本显著提升泛化能力  
✔ 结合 ISAT + Segment Anything 提升标注效率  
✔ 滑窗推理支持超高分辨率图像  
✔ 可用于灾害应急决策支持系统  

---

## 应用价值
本项目可直接应用于：

- 灾后应急路径规划
- 城市交通恢复分析
- 灾情评估系统
- 智慧城市遥感监测

具备实际部署与工程落地潜力。

---

## 项目总结
本研究提出一种基于 **Vision Transformer + LoRA 参数高效微调** 的遥感语义分割框架，在保持高精度的同时大幅降低训练成本与计算需求，在高分辨率卫星图像任务中实现性能与效率的最佳平衡，为灾害应急分析与城市规划提供可靠技术支撑。

---
